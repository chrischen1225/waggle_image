FROM waggle-node-controller-base:0.5

ARG branch=master
ARG server_host=beehive1.mcs.anl.gov

ADD . /usr/lib/waggle/waggle_image/
WORKDIR /usr/lib/waggle/waggle_image/

# RUN apt install -y tzdata ssh sudo psmisc

ENV ODROID_MODEL=ODROIDC
ENV NODE_ID_PREFIX=0d0c
RUN ./scripts/install_waggle.sh $server_host $branch

RUN cd /usr/lib/waggle && rm -rf waggle_image
