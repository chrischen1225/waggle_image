ARG base_version
ARG server_host=beehive1.mcs.anl.gov
ARG branch=master

FROM waggle-node-controller-base:$base_version

ADD . /usr/lib/waggle/waggle_image/
WORKDIR /usr/lib/waggle/waggle_image/

ENV ODROID_MODEL=ODROIDC
ENV NODE_ID_PREFIX=0d0c
RUN ./scripts/install_waggle.sh $server_host $branch core nodecontroller plugin_manager

RUN cd /usr/lib/waggle && rm -rf waggle_image
